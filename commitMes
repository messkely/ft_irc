fixed and added tests for QUIT
simplified password verification process